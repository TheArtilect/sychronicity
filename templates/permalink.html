{% extends "base.html" %}

{% block content %}
<div id="permalink">

    {% if edit_post %}
    <h2>Edit your blog</h2>
    <form method="post">
        <label><h3>Title</h3></label>
            <input type="text" name="title" value="{{post.title}}">

        <br>

        <h3>Posting</h3>
        <textarea name="change">{{ post.render_back() | safe }}</textarea>


        <br>
        <input type="submit" class="refresh">
    </form>


    {% else %}


        <div class='posts'>
            <div class='post-header text-center'>
                <h2 class="post-title">{{ post.title}}</h2>
                <h3>By: {{post.creator}}</h3>
            </div>
            <div class="post-content text-justify">
                {{ post.rendered_content() | safe }}
            </div>
            <div class="post-bottom container-fluid">
                <div class="row">
                    <div class="col-md-5">
                        {{post.last_modified.strftime("Last Modified: %b %d, %Y %I:%M %p")}}
                    </div>
                    <div class="col-md-offset-3 col-md-2">
                        {{post.number_of_likes()}} Likes
                    </div>
                    <div class="col-md-2">{{post.number_of_comments()}}  Comments</div>
                </div>
            </div>
        </div>

        <div class="container-fluid row-button">
            <p class='error text-center'>{{error}}</p>
            <div class="row">
                <div class='col-md-1'>
                    {% if user_already_liked %}
                    <form method="post">
                        <input type="submit" name="unlike" value="Unlike">
                    </form>
                    {% else %}
                    <form method="post">
                        <input type="submit" name="likes" value="Like">
                    </form>
                    {% endif %}
                </div>

                <div class="col-md-offset-5 col-md-1">
                    <form method="post">
                        <input type='submit' name='delete_post' value="Delete" id='delete-post-button'>
                    </form>
                </div>

                <div class=' col-md-offset-4 col-md-1'>
                    <form method='post'>
                        <input type='submit' name="edit" value="Edit">
                    </form>
                </div>
            </div>  <!-- row -->
        </div>      <!-- container-fluid -->

    <br>
    <div class='text-center'>
        <form method='post'>
            <h3>Post a comment below:</h3>
            <textarea id='comment-textarea' name="comment" value=""></textarea>
            <br>
            <div class='col-md-offset-8 col-md-1' id='comment-submit'>
                <input type='submit'>
            </div>
        </form>
    </div>
    <br>

    {% endif %}

<!--- not working, not saving to db
    {% if edit_comment %}
        <form method="post">
            <textarea name="edit_comment_text">{{comment_obj.unrender_comment()}}</textarea>
            <input type="submit">
        </form>
    {% endif %}
-->

    {% for comment in comments %}
    <div class="comment">
        <h5 class="comment-header">{{comment.user}} said:</h5>
        <p class='comment-content'>{{comment.rendered_comment() | safe }}</p>
        <p>{{comment.created.strftime("%I:%M %p on %b %d, %Y")}}<p>
        <form method="post">
            <input type="hidden" name="comment_id" value="{{comment.key().id()}}">
            <input type="submit" name="delete_comment" value="Delete">
        </form>
    <!--
        <form method="post">
            <input type="hidden" name="edit_comment_id" value="{{comment.key().id()}}">
            <input type="submit" name='edit_comment' value="Edit">
        </form>
-->
    </div>
    <hr>

    {% endfor %}
</div>


{% endblock %}
